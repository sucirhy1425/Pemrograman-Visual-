Public Class Form1
    Dim nilai1 As Double = 0
    Dim operasi As String = ""
    Dim baruInput As Boolean = True

    '=== ANGKA 0-9 ===
    Private Sub Angka_Click(sender As Object, e As EventArgs) Handles Button5.Click, Button6.Click, Button7.Click, Button9.Click, Button10.Click, Button11.Click, Button13.Click, Button14.Click, Button15.Click, Button16.Click
        Dim tombol As Button = sender
        If TextBox1.Text = "0" Or baruInput Then
            TextBox1.Text = tombol.Text
            baruInput = False
        Else
            TextBox1.Text &= tombol.Text
        End If
    End Sub

    '=== TITIK (.) ===
    Private Sub Button17_Click(sender As Object, e As EventArgs) Handles Button17.Click
        If Not TextBox1.Text.Contains(".") Then
            TextBox1.Text &= "."
        End If
    End Sub

    '=== OPERATOR + - * / ===
    Private Sub Operator_Click(sender As Object, e As EventArgs) Handles Button4.Click, Button8.Click, Button12.Click, Button18.Click
        Dim tombol As Button = sender
        nilai1 = Val(TextBox1.Text)
        operasi = tombol.Text
        baruInput = True
    End Sub

    '=== TOMBOL SAMA DENGAN (=) ===
    Private Sub Button19_Click(sender As Object, e As EventArgs) Handles Button19.Click
        Dim nilai2 As Double = Val(TextBox1.Text)
        Dim hasil As Double

        Select Case operasi
            Case "+"
                hasil = nilai1 + nilai2
            Case "-"
                hasil = nilai1 - nilai2
            Case "*"
                hasil = nilai1 * nilai2
            Case "/"
                If nilai2 = 0 Then
                    MessageBox.Show("Tidak bisa dibagi 0!")
                    Exit Sub
                Else
                    hasil = nilai1 / nilai2
                End If
        End Select

        TextBox1.Text = hasil.ToString()
        baruInput = True
    End Sub

    '=== TOMBOL CLEAR (C) ===
    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        TextBox1.Text = "0"
        nilai1 = 0
        operasi = ""
        baruInput = True
    End Sub

    '=== TOMBOL BACKSPACE (←) ===
    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click
        If TextBox1.Text.Length > 1 Then
            TextBox1.Text = TextBox1.Text.Substring(0, TextBox1.Text.Length - 1)
        Else
            TextBox1.Text = "0"
        End If
    End Sub

    '=== TOMBOL +/- (UBAH TANDA) ===
    Private Sub Button3_Click(sender As Object, e As EventArgs) Handles Button3.Click
        If TextBox1.Text.StartsWith("-") Then
            TextBox1.Text = TextBox1.Text.Substring(1)
        ElseIf TextBox1.Text <> "0" Then
            TextBox1.Text = "-" & TextBox1.Text
        End If
    End Sub
End Class
